<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® GameMonetize æ‰¹é‡å¯¼å…¥å·¥å…·</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #eee;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #6c5ce7;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #a0a0a0;
            margin-bottom: 30px;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab {
            padding: 12px 24px;
            background: #0f3460;
            border: none;
            color: #eee;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .tab:hover { background: #6c5ce7; }
        .tab.active { background: #6c5ce7; }
        .panel {
            display: none;
            background: #16213e;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .panel.active { display: block; }
        .step {
            background: #0f3460;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #6c5ce7;
        }
        .step-number {
            display: inline-block;
            width: 28px;
            height: 28px;
            background: #6c5ce7;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            margin-right: 10px;
            font-weight: bold;
        }
        pre {
            background: #0a0a1a;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.5;
            border: 1px solid #333;
        }
        code { color: #74b9ff; }
        textarea {
            width: 100%;
            min-height: 200px;
            background: #0a0a1a;
            color: #eee;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            resize: vertical;
        }
        textarea:focus {
            outline: none;
            border-color: #6c5ce7;
        }
        .btn {
            background: #6c5ce7;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s;
        }
        .btn:hover { background: #5f4dd1; transform: translateY(-2px); }
        .btn-success { background: #00b894; }
        .btn-success:hover { background: #00a085; }
        .btn-warning { background: #fdcb6e; color: #000; }
        .btn-warning:hover { background: #f9bf3b; }
        .output {
            background: #0a0a1a;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #333;
        }
        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: #0f3460;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            flex: 1;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #6c5ce7;
        }
        .stat-label {
            color: #a0a0a0;
            margin-top: 5px;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            font-size: 12px;
        }
        .code-container {
            position: relative;
        }
        .highlight { color: #ffeaa7; }
        .success { color: #55efc4; }
        .error { color: #ff7675; }
        a { color: #74b9ff; }
        .category-select {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        .category-option {
            background: #0f3460;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .category-option:hover { border-color: #6c5ce7; }
        .category-option.selected { background: #6c5ce7; border-color: #6c5ce7; }
        input[type="number"] {
            background: #0f3460;
            border: 2px solid #333;
            color: #eee;
            padding: 10px;
            border-radius: 6px;
            width: 100px;
        }
        input[type="number"]:focus {
            outline: none;
            border-color: #6c5ce7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® GameMonetize æ‰¹é‡å¯¼å…¥å·¥å…·</h1>
        <p class="subtitle">å¿«é€Ÿä» GameMonetize.com æ‰¹é‡æå–æ¸¸æˆæ•°æ®</p>

        <div class="tabs">
            <button class="tab active" onclick="showTab('method1')">ğŸ“‹ æ–¹æ³•1: æ§åˆ¶å°è„šæœ¬</button>
            <button class="tab" onclick="showTab('method2')">âœ¨ æ–¹æ³•2: æ•°æ®è½¬æ¢</button>
            <button class="tab" onclick="showTab('method3')">ğŸ”§ æ–¹æ³•3: æ‰‹åŠ¨æ·»åŠ </button>
            <button class="tab" onclick="showTab('dedup')">ğŸš€ æ™ºèƒ½å¯¼å…¥</button>
        </div>

        <!-- æ–¹æ³•1: æ§åˆ¶å°è„šæœ¬ -->
        <div id="method1" class="panel active">
            <h2>ğŸ“‹ æ–¹æ³•1: æµè§ˆå™¨æ§åˆ¶å°è„šæœ¬ (æ¨è)</h2>
            <p>è¿™æ˜¯æœ€ç®€å•å¿«æ·çš„æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æå–é¡µé¢ä¸Šçš„æ‰€æœ‰æ¸¸æˆã€‚</p>

            <div class="step">
                <span class="step-number">1</span>
                <strong>æ‰“å¼€ GameMonetize æ¸¸æˆé¡µé¢</strong><br>
                <a href="https://gamemonetize.com/games" target="_blank">ç‚¹å‡»è¿™é‡Œæ‰“å¼€ GameMonetize Games â†’</a>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                <strong>æ»šåŠ¨é¡µé¢åŠ è½½æ›´å¤šæ¸¸æˆ</strong><br>
                å‘ä¸‹æ»šåŠ¨é¡µé¢ï¼Œè®©æ›´å¤šæ¸¸æˆå¡ç‰‡åŠ è½½å‡ºæ¥ï¼ˆä½ æƒ³è¦å¤šå°‘å°±æ»šåŠ¨å¤šå°‘ï¼‰
            </div>

            <div class="step">
                <span class="step-number">3</span>
                <strong>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·</strong><br>
                æŒ‰ <code>F12</code> æˆ–å³é”® â†’ æ£€æŸ¥ â†’ åˆ‡æ¢åˆ° <code>Console</code> (æ§åˆ¶å°) æ ‡ç­¾
            </div>

            <div class="step">
                <span class="step-number">4</span>
                <strong>å¤åˆ¶å¹¶è¿è¡Œä»¥ä¸‹è„šæœ¬</strong><br>
                <div class="code-container">
                    <button class="btn copy-btn" onclick="copyScript()">ğŸ“‹ å¤åˆ¶è„šæœ¬</button>
                    <pre id="extraction-script"><code>// GameMonetize æ¸¸æˆæå–è„šæœ¬ v4.0
// åœ¨ gamemonetize.com/games é¡µé¢çš„æ§åˆ¶å°ä¸­è¿è¡Œ

(function() {
    // ========== é…ç½®åŒºï¼ˆä½¿ç”¨å‰è¯·ä¿®æ”¹ï¼ï¼‰==========
    // èµ·å§‹IDï¼šè®¾ç½®ä¸ºä½  games.js ä¸­æœ€å¤§ID + 1
    const startId = 941;  // â† ä¿®æ”¹è¿™é‡Œï¼
    
    // å·²å­˜åœ¨çš„æ¸¸æˆå“ˆå¸Œï¼ˆé˜²æ­¢é‡å¤å¯¼å…¥ï¼‰
    // ä½¿ç”¨"å»é‡æ£€æµ‹"åŠŸèƒ½ç”Ÿæˆï¼Œç²˜è´´åˆ°è¿™é‡Œ
    const existingHashes = new Set([
        // ç¤ºä¾‹ï¼ˆä½¿ç”¨å‰æ›¿æ¢ä¸ºä½ çš„åˆ—è¡¨ï¼‰ï¼š
        // "5r7akvnmm0t25uang36jgu02fek7qqr5",
    ]);
    // =============================================
    
    const games = [];
    let skipped = 0;
    
    document.querySelectorAll('a[href*="/play/"]').forEach(link => {
        try {
            const href = link.href;
            const img = link.querySelector('img');
            const titleEl = link.querySelector('span, .game-title, h3') || link;
            if (!img || !href) return;
            
            const match = href.match(/\/play\/([a-z0-9]+)/i);
            if (!match) return;
            
            const hash = match[1].toLowerCase();
            
            // è·³è¿‡å·²å­˜åœ¨çš„
            if (existingHashes.has(hash)) {
                skipped++;
                return;
            }
            
            const title = (titleEl.textContent || '').trim().replace(/\s+/g, ' ') || 'Game';
            
            games.push({ hash, title });
        } catch(e) {}
    });
    
    // é¡µé¢å†…å»é‡
    const unique = [...new Map(games.map(g => [g.hash, g])).values()];
    
    // ç”Ÿæˆä»£ç ï¼ˆIDé¡ºåºé€’å¢ï¼‰
    const code = unique.map((g, i) => `    {
        id: ${startId + i},
        title: "${g.title.replace(/"/g, '\\"')}",
        titleZh: "${g.title.replace(/"/g, '\\"')}",
        desc: "Fun HTML5 game!",
        descZh: "æœ‰è¶£çš„HTML5æ¸¸æˆï¼",
        category: "arcade",
        thumbnail: "https://img.gamemonetize.com/${g.hash}/512x384.jpg",
        url: "https://html5.gamemonetize.com/${g.hash}/",
        controls: "Mouse/Keyboard"
    }`).join(',\n');
    
    console.log('%câœ… æå–å®Œæˆï¼', 'color: #55efc4; font-size: 18px; font-weight: bold;');
    console.log(`%cğŸ“Š æ–°æ¸¸æˆ: ${unique.length} æ¬¾ | è·³è¿‡: ${skipped} æ¬¾`, 'color: #74b9ff; font-size: 14px;');
    console.log(`%cğŸ”¢ IDèŒƒå›´: ${startId} - ${startId + unique.length - 1}`, 'color: #ffeaa7;');
    console.log('%c\\nå¤åˆ¶ä¸‹é¢ä»£ç åˆ° games.jsï¼ˆåœ¨æœ€åä¸€ä¸ª } ååŠ é€—å·ï¼‰ï¼š\\n', 'color: #dfe6e9;');
    console.log(code);
    
    navigator.clipboard.writeText(code).then(() => {
        console.log('%c\\nğŸ“‹ å·²è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'color: #55efc4; font-size: 14px;');
    }).catch(() => {});
    
    return `Done! ${unique.length} games (ID: ${startId}-${startId + unique.length - 1})`;
})();</code></pre>
                </div>
            </div>

            <div class="step">
                <span class="step-number">5</span>
                <strong>è·å–ç»“æœ</strong><br>
                è„šæœ¬ä¼šè‡ªåŠ¨æå–é¡µé¢ä¸Šæ‰€æœ‰æ¸¸æˆï¼Œå¹¶å°†ä»£ç å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚å°†ä»£ç ç²˜è´´åˆ° <code>games.js</code> æ–‡ä»¶ä¸­å³å¯ï¼
            </div>
        </div>

        <!-- æ–¹æ³•2: æ•°æ®è½¬æ¢ -->
        <div id="method2" class="panel">
            <h2>âœ¨ æ–¹æ³•2: ç²˜è´´æ¸¸æˆé“¾æ¥æ‰¹é‡è½¬æ¢</h2>
            <p>å¦‚æœä½ æœ‰ä¸€ç»„æ¸¸æˆé“¾æ¥æˆ–æ¸¸æˆIDï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¹é‡è½¬æ¢ä¸ºä»£ç æ ¼å¼ã€‚</p>

            <div class="step">
                <strong>ç²˜è´´æ¸¸æˆé“¾æ¥ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</strong><br>
                æ”¯æŒæ ¼å¼ï¼š
                <ul>
                    <li><code>https://gamemonetize.com/play/xxxxx</code></li>
                    <li><code>https://html5.gamemonetize.com/xxxxx/</code></li>
                    <li>æˆ–ç›´æ¥ç²˜è´´æ¸¸æˆå“ˆå¸ŒID</li>
                </ul>
            </div>

            <textarea id="links-input" placeholder="ç²˜è´´æ¸¸æˆé“¾æ¥ï¼Œæ¯è¡Œä¸€ä¸ª...
ä¾‹å¦‚:
https://gamemonetize.com/play/5r7akvnmm0t25uang36jgu02fek7qqr5
https://html5.gamemonetize.com/1my1qdjwu871fk0992pvyobmnlu40t7n/
cejcp4vy4nc1lkflrx8jrpfcixw7e37b"></textarea>

            <div style="margin: 15px 0;">
                <label>èµ·å§‹ID: </label>
                <input type="number" id="start-id" value="1001" min="1">
                
                <label style="margin-left: 20px;">é»˜è®¤åˆ†ç±»: </label>
                <select id="default-category" style="background: #0f3460; border: 2px solid #333; color: #eee; padding: 10px; border-radius: 6px;">
                    <option value="arcade">ç»å…¸è¡—æœº</option>
                    <option value="puzzle">ç›Šæ™ºè§£è°œ</option>
                    <option value="action">åŠ¨ä½œå†’é™©</option>
                    <option value="racing">èµ›è½¦ç«é€Ÿ</option>
                    <option value="shooting">å°„å‡»æ¸¸æˆ</option>
                    <option value="casual">ä¼‘é—²å¨±ä¹</option>
                    <option value="sports">ä½“è‚²è¿åŠ¨</option>
                    <option value="adventure">å†’é™©æ¢ç´¢</option>
                    <option value="hypercasual">è¶…ä¼‘é—²</option>
                </select>
            </div>

            <button class="btn btn-success" onclick="convertLinks()">ğŸ”„ è½¬æ¢ä¸ºä»£ç </button>
            <button class="btn" onclick="document.getElementById('links-input').value=''">ğŸ—‘ï¸ æ¸…ç©º</button>

            <div class="output" id="links-output">è½¬æ¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            <button class="btn" onclick="copyOutput('links-output')" style="margin-top: 10px;">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
        </div>

        <!-- æ–¹æ³•3: æ‰‹åŠ¨æ·»åŠ  -->
        <div id="method3" class="panel">
            <h2>ğŸ”§ æ–¹æ³•3: æ‰‹åŠ¨æ·»åŠ å•ä¸ªæ¸¸æˆ</h2>
            <p>å¦‚æœä½ æƒ³ç²¾ç¡®æ§åˆ¶æ¯ä¸ªæ¸¸æˆçš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªè¡¨å•ã€‚</p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div>
                    <label>æ¸¸æˆå“ˆå¸ŒID *</label>
                    <input type="text" id="game-hash" placeholder="ä»URLä¸­è·å–ï¼Œå¦‚: 5r7akvnmm0t25uang36jgu02fek7qqr5" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>æ¸¸æˆID *</label>
                    <input type="number" id="game-id" value="1001" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>è‹±æ–‡æ ‡é¢˜ *</label>
                    <input type="text" id="game-title" placeholder="Tower Breaker" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>ä¸­æ–‡æ ‡é¢˜</label>
                    <input type="text" id="game-title-zh" placeholder="å¡”æ¥¼ç ´åè€…" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>è‹±æ–‡æè¿°</label>
                    <input type="text" id="game-desc" placeholder="Fun HTML5 game!" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>ä¸­æ–‡æè¿°</label>
                    <input type="text" id="game-desc-zh" placeholder="æœ‰è¶£çš„HTML5æ¸¸æˆï¼" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
                <div>
                    <label>åˆ†ç±»</label>
                    <select id="game-category" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                        <option value="arcade">ç»å…¸è¡—æœº</option>
                        <option value="puzzle">ç›Šæ™ºè§£è°œ</option>
                        <option value="action">åŠ¨ä½œå†’é™©</option>
                        <option value="racing">èµ›è½¦ç«é€Ÿ</option>
                        <option value="shooting">å°„å‡»æ¸¸æˆ</option>
                        <option value="casual">ä¼‘é—²å¨±ä¹</option>
                        <option value="sports">ä½“è‚²è¿åŠ¨</option>
                        <option value="adventure">å†’é™©æ¢ç´¢</option>
                        <option value="hypercasual">è¶…ä¼‘é—²</option>
                    </select>
                </div>
                <div>
                    <label>æ“ä½œæ–¹å¼</label>
                    <input type="text" id="game-controls" placeholder="Mouse/Keyboard" style="width: 100%; padding: 10px; background: #0f3460; border: 2px solid #333; color: #eee; border-radius: 6px; margin-top: 5px;">
                </div>
            </div>

            <button class="btn btn-success" onclick="generateSingle()" style="margin-top: 20px;">âœ¨ ç”Ÿæˆä»£ç </button>

            <div class="output" id="single-output">ç”Ÿæˆçš„ä»£ç å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            <button class="btn" onclick="copyOutput('single-output')" style="margin-top: 10px;">ğŸ“‹ å¤åˆ¶ä»£ç </button>
        </div>

        <!-- æ™ºèƒ½å¯¼å…¥ -->
        <div id="dedup" class="panel">
            <h2>ğŸš€ æ™ºèƒ½å¯¼å…¥ - ä¸€é”®ç”Ÿæˆä¸“å±è„šæœ¬</h2>
            <p>ç²˜è´´ä½ çš„ games.jsï¼Œè‡ªåŠ¨ç”Ÿæˆå¸¦å»é‡åŠŸèƒ½çš„æå–è„šæœ¬ï¼</p>

            <div class="step">
                <span class="step-number">1</span>
                <strong>ç²˜è´´ä½ çš„ games.js å†…å®¹</strong><br>
                æ‰“å¼€ <code>games.js</code> æ–‡ä»¶ï¼Œå…¨é€‰å¤åˆ¶ (Ctrl+A, Ctrl+C)ï¼Œç²˜è´´åˆ°ä¸‹é¢ï¼š
            </div>

            <textarea id="existing-games" placeholder="ç²˜è´´ä½ çš„ games.js æ–‡ä»¶å…¨éƒ¨å†…å®¹..." style="min-height: 150px;"></textarea>
            <button class="btn btn-success" onclick="generateSmartScript()">ğŸš€ ç”Ÿæˆä¸“å±æå–è„šæœ¬</button>
            
            <div id="existing-stats" class="stats" style="display: none;">
                <div class="stat-card">
                    <div class="stat-number" id="existing-count">0</div>
                    <div class="stat-label">ç°æœ‰æ¸¸æˆæ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="existing-max-id">0</div>
                    <div class="stat-label">æœ€å¤§ID</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="next-id">0</div>
                    <div class="stat-label">ä¸‹ä¸ªID</div>
                </div>
            </div>

            <div id="smart-script-output" class="output" style="display: none;">
                <div style="color: #55efc4; font-size: 16px; margin-bottom: 15px;">âœ… ä¸“å±è„šæœ¬å·²ç”Ÿæˆï¼</div>
                <div style="color: #ffeaa7; margin-bottom: 10px;">
                    ğŸ“‹ å¤åˆ¶ä¸‹é¢çš„è„šæœ¬ï¼Œåˆ° <a href="https://gamemonetize.com/games" target="_blank" style="color: #74b9ff;">GameMonetize</a> çš„æ§åˆ¶å°è¿è¡Œï¼š
                </div>
                <pre id="smart-script" style="white-space: pre-wrap; font-size: 11px; max-height: 400px; overflow-y: auto;"></pre>
            </div>
            <button class="btn" id="copy-smart-btn" onclick="copySmartScript()" style="display: none; margin-top: 10px;">ğŸ“‹ å¤åˆ¶è„šæœ¬åˆ°å‰ªè´´æ¿</button>

            <hr style="border-color: #333; margin: 30px 0;">

            <h3>ğŸ”§ æ‰‹åŠ¨å»é‡æ£€æµ‹ï¼ˆå¯é€‰ï¼‰</h3>
            <p style="color: #a0a0a0; font-size: 14px;">å¦‚æœä½ å·²ç»æœ‰æå–å¥½çš„ä»£ç ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ£€æµ‹é‡å¤ï¼š</p>

            <textarea id="new-games" placeholder="ç²˜è´´è¦å¯¼å…¥çš„æ–°æ¸¸æˆä»£ç ..." style="min-height: 100px;"></textarea>
            
            <button class="btn" onclick="checkDuplicates()">ğŸ” æ£€æµ‹é‡å¤</button>
            <button class="btn" onclick="autoFixIds()">ğŸ”§ ä¿®å¤ID</button>

            <div class="output" id="dedup-output">
                <p style="color: #a0a0a0;">æ£€æµ‹ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
            </div>
            <button class="btn" onclick="copyOutput('dedup-output')" style="margin-top: 10px;">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div style="background: #16213e; border-radius: 12px; padding: 25px; margin-top: 20px;">
            <h3>ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
            <ol style="line-height: 2;">
                <li>ä½¿ç”¨ä¸Šé¢çš„å·¥å…·è·å–æ¸¸æˆä»£ç </li>
                <li>æ‰“å¼€ä½ çš„ <code>games.js</code> æ–‡ä»¶</li>
                <li>æ‰¾åˆ° <code>const games = [</code> æ•°ç»„</li>
                <li>åœ¨æœ€åä¸€ä¸ªæ¸¸æˆå¯¹è±¡çš„ <code>}</code> åé¢åŠ ä¸Šé€—å· <code>,</code></li>
                <li>ç²˜è´´æ–°çš„æ¸¸æˆä»£ç </li>
                <li>ä¿å­˜æ–‡ä»¶ï¼Œåˆ·æ–°ç½‘ç«™æŸ¥çœ‹æ•ˆæœ</li>
            </ol>

            <h3 style="margin-top: 20px;">âš ï¸ æ³¨æ„äº‹é¡¹</h3>
            <ul style="line-height: 2;">
                <li>æ¸¸æˆIDä¸è¦é‡å¤ï¼Œå»ºè®®ä½¿ç”¨1001å¼€å§‹çš„æ•°å­—</li>
                <li>å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹æ¸¸æˆçš„ä¸­æ–‡æ ‡é¢˜å’Œæè¿°</li>
                <li>å¯ä»¥æ ¹æ®æ¸¸æˆç±»å‹ä¿®æ”¹åˆ†ç±» (category)</li>
                <li>å›¾ç‰‡URLå’Œæ¸¸æˆURLçš„å“ˆå¸ŒIDå¿…é¡»ä¸€è‡´</li>
            </ul>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function copyScript() {
            const script = document.getElementById('extraction-script').textContent;
            navigator.clipboard.writeText(script).then(() => {
                alert('âœ… è„šæœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\nç°åœ¨å» GameMonetize ç½‘ç«™çš„æ§åˆ¶å°ä¸­ç²˜è´´è¿è¡Œå§ï¼');
            });
        }

        function convertLinks() {
            const input = document.getElementById('links-input').value.trim();
            const startId = parseInt(document.getElementById('start-id').value) || 1001;
            const category = document.getElementById('default-category').value;
            const output = document.getElementById('links-output');

            if (!input) {
                output.innerHTML = '<span class="error">âŒ è¯·å…ˆç²˜è´´æ¸¸æˆé“¾æ¥ï¼</span>';
                return;
            }

            const lines = input.split('\n').filter(l => l.trim());
            const games = [];

            lines.forEach((line, index) => {
                line = line.trim();
                let hash = '';

                // å°è¯•æå–å“ˆå¸ŒID
                if (line.includes('/play/')) {
                    const match = line.match(/\/play\/([a-z0-9]+)/i);
                    if (match) hash = match[1];
                } else if (line.includes('html5.gamemonetize.com')) {
                    const match = line.match(/gamemonetize\.com\/([a-z0-9]+)/i);
                    if (match) hash = match[1];
                } else if (/^[a-z0-9]+$/i.test(line)) {
                    hash = line;
                }

                if (hash && hash.length > 10) {
                    games.push({
                        id: startId + index,
                        hash: hash,
                        category: category
                    });
                }
            });

            if (games.length === 0) {
                output.innerHTML = '<span class="error">âŒ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ¸¸æˆé“¾æ¥ï¼</span>';
                return;
            }

            const code = games.map(g => `    {
        id: ${g.id},
        title: "Game ${g.id}",
        titleZh: "æ¸¸æˆ ${g.id}",
        desc: "Fun HTML5 game - play now!",
        descZh: "æœ‰è¶£çš„HTML5æ¸¸æˆï¼",
        category: "${g.category}",
        thumbnail: "https://img.gamemonetize.com/${g.hash}/512x384.jpg",
        url: "https://html5.gamemonetize.com/${g.hash}/",
        controls: "Mouse/Keyboard"
    }`).join(',\n');

            output.innerHTML = `<span class="success">âœ… æˆåŠŸè½¬æ¢ ${games.length} æ¬¾æ¸¸æˆï¼</span>\n<pre style="margin-top: 10px; white-space: pre-wrap;">${code}</pre>`;
        }

        function generateSingle() {
            const hash = document.getElementById('game-hash').value.trim();
            const id = document.getElementById('game-id').value;
            const title = document.getElementById('game-title').value.trim() || 'New Game';
            const titleZh = document.getElementById('game-title-zh').value.trim() || title;
            const desc = document.getElementById('game-desc').value.trim() || 'Fun HTML5 game!';
            const descZh = document.getElementById('game-desc-zh').value.trim() || 'æœ‰è¶£çš„HTML5æ¸¸æˆï¼';
            const category = document.getElementById('game-category').value;
            const controls = document.getElementById('game-controls').value.trim() || 'Mouse/Keyboard';
            const output = document.getElementById('single-output');

            if (!hash) {
                output.innerHTML = '<span class="error">âŒ è¯·è¾“å…¥æ¸¸æˆå“ˆå¸ŒIDï¼</span>';
                return;
            }

            // æ¸…ç†hash
            let cleanHash = hash;
            if (hash.includes('/')) {
                const match = hash.match(/([a-z0-9]{20,})/i);
                if (match) cleanHash = match[1];
            }

            const code = `    {
        id: ${id},
        title: "${title.replace(/"/g, '\\"')}",
        titleZh: "${titleZh.replace(/"/g, '\\"')}",
        desc: "${desc.replace(/"/g, '\\"')}",
        descZh: "${descZh.replace(/"/g, '\\"')}",
        category: "${category}",
        thumbnail: "https://img.gamemonetize.com/${cleanHash}/512x384.jpg",
        url: "https://html5.gamemonetize.com/${cleanHash}/",
        controls: "${controls}"
    }`;

            output.innerHTML = `<span class="success">âœ… ä»£ç ç”ŸæˆæˆåŠŸï¼</span>\n<pre style="margin-top: 10px;">${code}</pre>`;
            
            // è‡ªåŠ¨å¢åŠ ID
            document.getElementById('game-id').value = parseInt(id) + 1;
        }

        function copyOutput(elementId) {
            const el = document.getElementById(elementId);
            const pre = el.querySelector('pre');
            if (pre) {
                navigator.clipboard.writeText(pre.textContent).then(() => {
                    alert('âœ… ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            } else {
                alert('âŒ æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
            }
        }

        // å»é‡æ£€æµ‹ç›¸å…³å˜é‡
        let existingHashes = new Set();
        let existingIds = new Set();
        let maxExistingId = 0;

        // è§£æç°æœ‰æ¸¸æˆ
        function parseExistingGames() {
            const input = document.getElementById('existing-games').value;
            existingHashes = new Set();
            existingIds = new Set();
            maxExistingId = 0;

            // æå–æ‰€æœ‰å“ˆå¸ŒID (ä»URLä¸­)
            const hashMatches = input.matchAll(/gamemonetize\.com\/([a-z0-9]{20,})/gi);
            for (const match of hashMatches) {
                existingHashes.add(match[1].toLowerCase());
            }

            // æå–æ‰€æœ‰æ¸¸æˆID
            const idMatches = input.matchAll(/id:\s*(\d+)/g);
            for (const match of idMatches) {
                const id = parseInt(match[1]);
                existingIds.add(id);
                if (id > maxExistingId) maxExistingId = id;
            }

            // æ˜¾ç¤ºç»Ÿè®¡
            document.getElementById('existing-stats').style.display = 'flex';
            document.getElementById('existing-count').textContent = existingHashes.size;
            document.getElementById('existing-max-id').textContent = maxExistingId;

            // æ›´æ–°èµ·å§‹IDå»ºè®®
            document.getElementById('start-id').value = maxExistingId + 1;

            alert(`âœ… è§£æå®Œæˆï¼\n\nå‘ç° ${existingHashes.size} æ¬¾ç°æœ‰æ¸¸æˆ\nå½“å‰æœ€å¤§ID: ${maxExistingId}\n\nğŸ‘‰ æ–°æ¸¸æˆè¯·ä» ID ${maxExistingId + 1} å¼€å§‹\nğŸ‘‰ è¯·å°†æ§åˆ¶å°è„šæœ¬ä¸­çš„ startId æ”¹ä¸º ${maxExistingId + 1}`);
        }

        // ç”Ÿæˆæ™ºèƒ½è„šæœ¬ï¼ˆè‡ªåŠ¨åŒ…å«startIdå’Œå“ˆå¸Œåˆ—è¡¨ï¼‰
        function generateSmartScript() {
            const input = document.getElementById('existing-games').value;
            
            if (!input.trim()) {
                alert('âŒ è¯·å…ˆç²˜è´´ games.js å†…å®¹ï¼');
                return;
            }

            // é‡ç½®
            existingHashes = new Set();
            existingIds = new Set();
            maxExistingId = 0;

            // æå–æ‰€æœ‰å“ˆå¸ŒID
            const hashMatches = input.matchAll(/gamemonetize\.com\/([a-z0-9]{20,})/gi);
            for (const match of hashMatches) {
                existingHashes.add(match[1].toLowerCase());
            }

            // æå–æ‰€æœ‰æ¸¸æˆID
            const idMatches = input.matchAll(/id:\s*(\d+)/g);
            for (const match of idMatches) {
                const id = parseInt(match[1]);
                existingIds.add(id);
                if (id > maxExistingId) maxExistingId = id;
            }

            if (existingHashes.size === 0) {
                alert('âŒ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ¸¸æˆæ•°æ®ï¼\nè¯·ç¡®ä¿ç²˜è´´äº†å®Œæ•´çš„ games.js æ–‡ä»¶å†…å®¹ã€‚');
                return;
            }

            const nextId = maxExistingId + 1;

            // æ˜¾ç¤ºç»Ÿè®¡
            document.getElementById('existing-stats').style.display = 'flex';
            document.getElementById('existing-count').textContent = existingHashes.size;
            document.getElementById('existing-max-id').textContent = maxExistingId;
            document.getElementById('next-id').textContent = nextId;

            // ç”Ÿæˆå“ˆå¸Œåˆ—è¡¨å­—ç¬¦ä¸²
            const hashArray = Array.from(existingHashes);
            const hashListStr = hashArray.map(h => `"${h}"`).join(',');

            // ç”Ÿæˆå®Œæ•´è„šæœ¬
            const smartScript = `// ğŸ® GameMonetize æ™ºèƒ½æå–è„šæœ¬
// è‡ªåŠ¨ç”Ÿæˆäº ${new Date().toLocaleString()}
// ç°æœ‰æ¸¸æˆ: ${existingHashes.size} æ¬¾ | èµ·å§‹ID: ${nextId}

(function() {
    const startId = ${nextId};
    const existingHashes = new Set([${hashListStr}]);
    
    const games = [];
    let skipped = 0;
    
    document.querySelectorAll('a[href*="/play/"]').forEach(link => {
        try {
            const href = link.href;
            const img = link.querySelector('img');
            const titleEl = link.querySelector('span, .game-title, h3') || link;
            if (!img || !href) return;
            
            const match = href.match(/\\/play\\/([a-z0-9]+)/i);
            if (!match) return;
            
            const hash = match[1].toLowerCase();
            if (existingHashes.has(hash)) { skipped++; return; }
            
            const title = (titleEl.textContent || '').trim().replace(/\\s+/g, ' ') || 'Game';
            games.push({ hash, title });
        } catch(e) {}
    });
    
    const unique = [...new Map(games.map(g => [g.hash, g])).values()];
    
    const code = unique.map((g, i) => \`    {
        id: \${startId + i},
        title: "\${g.title.replace(/"/g, '\\\\"')}",
        titleZh: "\${g.title.replace(/"/g, '\\\\"')}",
        desc: "Fun HTML5 game!",
        descZh: "æœ‰è¶£çš„HTML5æ¸¸æˆï¼",
        category: "arcade",
        thumbnail: "https://img.gamemonetize.com/\${g.hash}/512x384.jpg",
        url: "https://html5.gamemonetize.com/\${g.hash}/",
        controls: "Mouse/Keyboard"
    }\`).join(',\\n');
    
    console.log('%câœ… æå–å®Œæˆï¼', 'color: #55efc4; font-size: 18px; font-weight: bold;');
    console.log(\`%cğŸ“Š æ–°æ¸¸æˆ: \${unique.length} æ¬¾ | è·³è¿‡é‡å¤: \${skipped} æ¬¾\`, 'color: #74b9ff; font-size: 14px;');
    if (unique.length > 0) {
        console.log(\`%cğŸ”¢ IDèŒƒå›´: \${startId} - \${startId + unique.length - 1}\`, 'color: #ffeaa7;');
        console.log('%c\\nğŸ“‹ å¤åˆ¶ä¸‹é¢ä»£ç åˆ° games.jsï¼ˆåœ¨æœ€åä¸€ä¸ª } ååŠ é€—å·ï¼‰ï¼š\\n', 'color: #dfe6e9;');
        console.log(code);
        navigator.clipboard.writeText(code).then(() => {
            console.log('%c\\nâœ… å·²è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'color: #55efc4; font-size: 14px;');
        }).catch(() => {});
    }
    return \`Done! \${unique.length} new games\`;
})();`;

            // æ˜¾ç¤ºè„šæœ¬
            document.getElementById('smart-script-output').style.display = 'block';
            document.getElementById('smart-script').textContent = smartScript;
            document.getElementById('copy-smart-btn').style.display = 'inline-block';

            // æ›´æ–°å…¶ä»–åœ°æ–¹çš„èµ·å§‹ID
            document.getElementById('start-id').value = nextId;
        }

        // å¤åˆ¶æ™ºèƒ½è„šæœ¬
        function copySmartScript() {
            const script = document.getElementById('smart-script').textContent;
            navigator.clipboard.writeText(script).then(() => {
                alert('âœ… è„šæœ¬å·²å¤åˆ¶ï¼\\n\\nç°åœ¨å» GameMonetize ç½‘ç«™ï¼š\\n1. æ»šåŠ¨åŠ è½½æƒ³è¦çš„æ¸¸æˆ\\n2. F12 æ‰“å¼€æ§åˆ¶å°\\n3. ç²˜è´´è¿è¡Œè„šæœ¬\\n4. ä»£ç è‡ªåŠ¨å¤åˆ¶ï¼Œç²˜è´´åˆ° games.js å³å¯ï¼');
            });
        }

        // æ£€æµ‹é‡å¤
        function checkDuplicates() {
            const newGamesInput = document.getElementById('new-games').value;
            const output = document.getElementById('dedup-output');

            if (existingHashes.size === 0) {
                output.innerHTML = '<span class="error">âŒ è¯·å…ˆè§£æç°æœ‰çš„ games.jsï¼</span>';
                return;
            }

            if (!newGamesInput.trim()) {
                output.innerHTML = '<span class="error">âŒ è¯·ç²˜è´´è¦å¯¼å…¥çš„æ–°æ¸¸æˆä»£ç ï¼</span>';
                return;
            }

            // æå–æ–°æ¸¸æˆçš„å“ˆå¸ŒID
            const newGameBlocks = newGamesInput.split(/\},\s*\{/);
            const duplicates = [];
            const unique = [];
            let newMaxId = maxExistingId;

            newGameBlocks.forEach((block, index) => {
                // æå–å“ˆå¸ŒID
                const hashMatch = block.match(/gamemonetize\.com\/([a-z0-9]{20,})/i);
                if (!hashMatch) return;

                const hash = hashMatch[1].toLowerCase();
                
                // æå–ID
                const idMatch = block.match(/id:\s*(\d+)/);
                const currentId = idMatch ? parseInt(idMatch[1]) : 0;

                if (existingHashes.has(hash)) {
                    duplicates.push({ hash, block: block.substring(0, 100) + '...' });
                } else {
                    // é‡æ–°åˆ†é…ID
                    newMaxId++;
                    let cleanBlock = block;
                    if (idMatch) {
                        cleanBlock = block.replace(/id:\s*\d+/, `id: ${newMaxId}`);
                    }
                    unique.push(cleanBlock);
                }
            });

            // é‡æ–°ç»„è£…ä»£ç 
            let resultCode = '';
            if (unique.length > 0) {
                resultCode = unique.map((block, i) => {
                    let cleaned = block.trim();
                    // ç¡®ä¿æ ¼å¼æ­£ç¡®
                    if (!cleaned.startsWith('{')) cleaned = '{' + cleaned;
                    if (!cleaned.endsWith('}')) cleaned = cleaned + '}';
                    return '    ' + cleaned.replace(/^\s*\{/, '{').replace(/\}\s*$/, '}');
                }).join(',\n');
            }

            // æ˜¾ç¤ºç»“æœ
            let html = `<div style="margin-bottom: 15px;">
                <span class="success">âœ… æ£€æµ‹å®Œæˆï¼</span>
                <div class="stats" style="margin-top: 10px;">
                    <div class="stat-card" style="flex: 1;">
                        <div class="stat-number" style="color: #55efc4;">${unique.length}</div>
                        <div class="stat-label">å¯å¯¼å…¥ï¼ˆæ— é‡å¤ï¼‰</div>
                    </div>
                    <div class="stat-card" style="flex: 1;">
                        <div class="stat-number" style="color: #ff7675;">${duplicates.length}</div>
                        <div class="stat-label">å·²è¿‡æ»¤ï¼ˆé‡å¤ï¼‰</div>
                    </div>
                </div>
            </div>`;

            if (duplicates.length > 0) {
                html += `<details style="margin-bottom: 15px;">
                    <summary style="cursor: pointer; color: #ff7675;">æŸ¥çœ‹ ${duplicates.length} ä¸ªé‡å¤æ¸¸æˆ</summary>
                    <ul style="font-size: 12px; color: #a0a0a0;">
                        ${duplicates.map(d => `<li>${d.hash.substring(0, 20)}...</li>`).join('')}
                    </ul>
                </details>`;
            }

            if (unique.length > 0) {
                html += `<div style="color: #ffeaa7; margin-bottom: 10px;">ğŸ“‹ ä»¥ä¸‹æ˜¯å»é‡åçš„ä»£ç ï¼ˆIDå·²è‡ªåŠ¨é‡æ–°åˆ†é…ï¼‰ï¼š</div>
                    <pre style="white-space: pre-wrap; font-size: 11px;">${escapeHtml(resultCode)}</pre>`;
            } else {
                html += `<div style="color: #fdcb6e;">âš ï¸ æ‰€æœ‰æ¸¸æˆéƒ½å·²å­˜åœ¨ï¼Œæ²¡æœ‰æ–°æ¸¸æˆå¯å¯¼å…¥ã€‚</div>`;
            }

            output.innerHTML = html;
        }

        // è‡ªåŠ¨ä¿®å¤ID
        function autoFixIds() {
            const newGamesInput = document.getElementById('new-games').value;
            const output = document.getElementById('dedup-output');

            if (!newGamesInput.trim()) {
                output.innerHTML = '<span class="error">âŒ è¯·å…ˆç²˜è´´è¦å¯¼å…¥çš„æ–°æ¸¸æˆä»£ç ï¼</span>';
                return;
            }

            let startId = maxExistingId > 0 ? maxExistingId + 1 : 1001;
            let currentId = startId;

            // æ›¿æ¢æ‰€æœ‰ID
            const fixed = newGamesInput.replace(/id:\s*\d+/g, () => {
                return `id: ${currentId++}`;
            });

            output.innerHTML = `<span class="success">âœ… IDå·²è‡ªåŠ¨ä¿®å¤ï¼</span>
                <div style="color: #ffeaa7; margin: 10px 0;">æ–°IDèŒƒå›´: ${startId} - ${currentId - 1}</div>
                <pre style="white-space: pre-wrap; font-size: 11px;">${escapeHtml(fixed)}</pre>`;
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>

